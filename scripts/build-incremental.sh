#!/usr/bin/env bash
set -euo pipefail

# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð˜ÐÐšÐ Ð•ÐœÐ•ÐÐ¢ÐÐ›Ð¬ÐÐžÐ™ ÑÐ±Ð¾Ñ€ÐºÐ¸ Ð½Ð° Linux
#
# ÐšÐžÐ“Ð”Ð Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð¬:
# - ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ (Ð±Ñ‹ÑÑ‚Ñ€Ð¾, ~5-10 ÑÐµÐº)
# - ÐŸÐ¾ÑÐ»Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð² Ð¸ÑÑ…Ð¾Ð´Ð½Ð¸ÐºÐ°Ñ…
# - ÐŸÑ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ñ‚ÐµÑÑ‚Ð¾Ð²
#
# Ð§Ð¢Ðž Ð”Ð•Ð›ÐÐ•Ð¢:
# - Ð£Ð±Ð¸Ð²Ð°ÐµÑ‚ Ð·Ð°Ð²Ð¸ÑÑˆÐ¸Ðµ Swift Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ (fix Ð´Ð»Ñ SwiftPM Ð·Ð°Ð²Ð¸ÑÐ°Ð½Ð¸Ð¹)
# - Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ .build ÐºÑÑˆ (Ð½Ðµ Ð¿ÐµÑ€ÐµÑÐ¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸)
# - ÐŸÐµÑ€ÐµÑÐ¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð·Ð¼ÐµÐ½Ñ‘Ð½Ð½Ñ‹Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ð¸
#
# ÐšÐžÐ“Ð”Ð ÐÐ• Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð¬:
# - Ð•ÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð° Ñ‡Ð¸ÑÑ‚Ð°Ñ ÑÐ±Ð¾Ñ€ÐºÐ° â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ build-clean.sh
# - ÐŸÑ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ Package.swift â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ build-clean.sh

echo "ðŸ§¹ Ð£Ð±Ð¸Ð²Ð°ÐµÐ¼ Ð·Ð°Ð²Ð¸ÑÑˆÐ¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Swift..."
pkill -9 swift 2>/dev/null || true
pkill -9 sourcekit-lsp 2>/dev/null || true
sleep 1

echo "ðŸ”¨ Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð¿Ñ€Ð¾ÐµÐºÑ‚ (Ð¸Ð½ÐºÑ€ÐµÐ¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ð¾)..."
swift build

echo "âœ… Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°!"
