# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Linux-—Å–µ—Ä–≤–µ—Ä–µ

> ‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è Ubuntu 24.04 –∏ Swift 6.2. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∏–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã –∏ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.

## SSH –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–µ—Ä–≤–µ—Ä—É

–ü—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `~/.ssh/config` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–∏–∞—Å –∏–∑ SSH config)
ssh ufohosting

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
ssh root@45.8.145.191
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–∫–ª—é—á–∞ (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):**
- SSH-–∫–ª—é—á: `~/.ssh/ufohosting`
- –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª—é—á–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —á–µ—Ä–µ–∑ `UseKeychain yes` –≤ `~/.ssh/config`
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ macOS –∫–ª—é—á –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏
ssh-add -l

# –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
ssh-add --apple-use-keychain ~/.ssh/ufohosting
```

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Swift –Ω–∞ Linux

```bash
# Ubuntu/Debian
wget https://download.swift.org/swift-6.0.3-release/ubuntu2204/swift-6.0.3-RELEASE/swift-6.0.3-RELEASE-ubuntu22.04.tar.gz
tar xzf swift-6.0.3-RELEASE-ubuntu22.04.tar.gz
sudo mv swift-6.0.3-RELEASE-ubuntu22.04 /usr/share/swift
echo 'export PATH=/usr/share/swift/usr/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# –ü—Ä–æ–≤–µ—Ä–∫–∞
swift --version
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ TDLib

> üí° **–í–ê–ñ–ù–û:** –î–ª—è Ubuntu 24.04 –≥–æ—Ç–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ TDLib –Ω–µ—Ç, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–∞ —Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç 20-40 –º–∏–Ω—É—Ç –Ω–∞ 1 CPU core.

> ‚ö†Ô∏è **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `tmux` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏, —á—Ç–æ–±—ã –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –ø—Ä–µ—Ä–≤–∞–ª—Å—è –ø—Ä–∏ –æ–±—Ä—ã–≤–µ SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è!

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Å–±–æ—Ä–∫–∏ TDLib
sudo apt update
sudo apt install -y build-essential cmake gperf libssl-dev zlib1g-dev pkg-config tmux git

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è TDLib
cd ~
git clone https://github.com/tdlib/td.git
cd td

# –í–ê–ñ–ù–û: –ó–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä–∫—É –≤ tmux-—Å–µ—Å—Å–∏–∏
tmux new-session -d -s tdlib-build "cd ~/td && mkdir -p build && cd build && cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local .. && cmake --build . -j\$(nproc) 2>&1 | tee build.log; echo 'Build finished with exit code:' \$?"

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å:
tmux attach -t tdlib-build

# –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç tmux (–ù–ï –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è —Å–±–æ—Ä–∫—É): Ctrl+B, –∑–∞—Ç–µ–º D

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏ (–ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è):
tail -f ~/td/build/build.log

# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏: —É—Å—Ç–∞–Ω–æ–≤–∫–∞
cd ~/td/build
sudo cmake --install .

# –û–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (—á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—à–ª–∞ libtdjson.so)
sudo ldconfig

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
ldconfig -p | grep tdjson  # –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
pkg-config --modversion tdjson
```

**–î–ª—è Ubuntu 22.04 –∏ –Ω–∏–∂–µ** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≥–æ—Ç–æ–≤—ã–π –ø–∞–∫–µ—Ç):
```bash
sudo apt update
sudo apt install -y libtdjson-dev pkg-config
pkg-config --modversion tdjson
```

#### –ü—Ä–æ–±–ª–µ–º–∞: Out of Memory (OOM) –ø—Ä–∏ —Å–±–æ—Ä–∫–µ

TDLib —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ RAM –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (~700-800MB –Ω–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞). –ù–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —Å –º–∞–ª—ã–º –æ–±—ä—ë–º–æ–º –ø–∞–º—è—Ç–∏ (1GB) –∫–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–µ—Ä–≤–∞—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π OOM.

**–†–µ—à–µ–Ω–∏–µ: –£–≤–µ–ª–∏—á–∏—Ç—å swap**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π swap
swapon --show

# –ï—Å–ª–∏ OOM Killer —É–±–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
dmesg | grep -i "killed process"

# –°–æ–∑–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π swap (2GB)
sudo dd if=/dev/zero of=/swapfile2 bs=1M count=2048
sudo chmod 600 /swapfile2
sudo mkswap /swapfile2
sudo swapon /swapfile2

# –ü—Ä–æ–≤–µ—Ä–∫–∞
swapon --show
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 2 —Ñ–∞–π–ª–∞ swap

# –°–¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º (–¥–æ–±–∞–≤–∏—Ç—å –≤ fstab)
echo '/swapfile2 none swap sw 0 0' | sudo tee -a /etc/fstab
```

**–°–Ω–∏–∑–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º —Å–±–æ—Ä–∫–∏:**

```bash
# –í–º–µ—Å—Ç–æ -j$(nproc) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å -j1 (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏)
cmake --build . -j1
```

#### –ü–ª–∞–Ω –ë: –°–±–æ—Ä–∫–∞ –≤ Docker (–µ—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è)

–ï—Å–ª–∏ –¥–∞–∂–µ —Å–æ swap —Å–±–æ—Ä–∫–∞ –Ω–µ –∏–¥—ë—Ç, –º–æ–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å TDLib –ª–æ–∫–∞–ª—å–Ω–æ –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

**‚ö†Ô∏è –í–µ—Ä—Å–∏—è Ubuntu –≤ Docker –î–û–õ–ñ–ù–ê —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º (Ubuntu 24.04)!**

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (macOS/Linux):

# 1. –°–æ–±—Ä–∞—Ç—å TDLib –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Ubuntu 24.04
docker run --rm -v $(pwd)/tdlib-build:/output ubuntu:24.04 bash -c "
  apt-get update &&
  apt-get install -y build-essential cmake gperf libssl-dev zlib1g-dev git &&
  git clone https://github.com/tdlib/td.git /tmp/td &&
  cd /tmp/td && mkdir build && cd build &&
  cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/output .. &&
  cmake --build . -j\$(nproc) &&
  cmake --install .
"

# 2. –£–ø–∞–∫–æ–≤–∞—Ç—å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏
tar czf tdlib-ubuntu24.tar.gz -C tdlib-build .

# 3. –ü–µ—Ä–µ–¥–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp tdlib-ubuntu24.tar.gz ufohosting:~/

# 4. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
ssh ufohosting 'sudo tar xzf ~/tdlib-ubuntu24.tar.gz -C /usr/local && rm ~/tdlib-ubuntu24.tar.gz'

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞
ssh ufohosting 'pkg-config --modversion tdjson'
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Å–±–æ—Ä–∫–∏

```bash
sudo apt install -y build-essential libssl-dev libreadline-dev
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SwiftLint (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞)

SwiftLint –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Swift Package Manager, –Ω–æ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫:

```bash
# –°–∫–∞—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é SwiftLint –¥–ª—è Linux
wget https://github.com/realm/SwiftLint/releases/download/0.57.0/swiftlint_linux.zip
unzip swiftlint_linux.zip
sudo mv swiftlint /usr/local/bin/
sudo chmod +x /usr/local/bin/swiftlint

# –ü—Ä–æ–≤–µ—Ä–∫–∞
swiftlint version
```

**–ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞:**
```bash
cd ~/tg-client
swiftlint lint
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** SwiftLint –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º.

## –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
cd ~
git clone <your-repo-url> tg-client
cd tg-client
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (–æ–Ω –Ω–µ –±—É–¥–µ—Ç –∑–∞–∫–æ–º–º–∏—á–µ–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è .gitignore):

> üìñ **–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Telegram API credentials:** –°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ [CREDENTIALS.md](CREDENTIALS.md)

```bash
cat > .env << 'EOF'
export TELEGRAM_API_ID=<your_api_id>
export TELEGRAM_API_HASH=<your_api_hash>
export TDLIB_STATE_DIR=$HOME/.tdlib
export PKG_CONFIG_PATH="/usr/lib/pkgconfig:$PKG_CONFIG_PATH"
EOF

chmod 600 .env
```

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```bash
source .env
```

## –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### ‚ö†Ô∏è Known Issue: SwiftPM Build Hangs on Linux

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞ Linux-—Å–µ—Ä–≤–µ—Ä–∞—Ö (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ Ubuntu 24.04) –∫–æ–º–∞–Ω–¥–∞ `swift build` –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–∞—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ "Planning build". –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU –ø—Ä–∏ —ç—Ç–æ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (~0%).

**–°–∏–º–ø—Ç–æ–º—ã**:
- `swift build` –≤–∏—Å–∏—Ç –Ω–∞ "Planning build" –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏, —Ç–∞–∫ –∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö
- –î–∞–∂–µ –µ—Å–ª–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫ —É–∂–µ —Å–æ–±—Ä–∞–Ω
- –°–æ–æ–±—â–µ–Ω–∏–µ: "Another instance of SwiftPM (PID: XXX) is already running..."

**–ü—Ä–∏—á–∏–Ω–∞**: SwiftPM —Å–æ–∑–¥–∞—ë—Ç lock-—Ñ–∞–π–ª—ã –≤ `.build/`. –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª —É–±–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (Ctrl+C, kill, —Ä–∞–∑—Ä—ã–≤ SSH), lock –æ—Å—Ç–∞—ë—Ç—Å—è.

### –†–µ—à–µ–Ω–∏–µ: –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±–æ—Ä–∫–∏

‚ö†Ô∏è **–í–ê–ñ–ù–û (Swift 6.2 –Ω–∞ Linux):** –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º SwiftPM. –ö–∞–∂–¥–∞—è —Å–±–æ—Ä–∫–∞ = –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (~50-60 —Å–µ–∫).

**–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±–æ—Ä–∫–∏:**

```bash
./scripts/build-clean.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£–±–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å—à–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Swift
- –û—á–∏—â–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–µ—à SwiftPM (`swift package purge-cache`)
- –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π .build (`swift package reset`)
- –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç (~50-60 —Å–µ–∫)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –í—Å–µ–≥–¥–∞ (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ Linux)
- ‚úÖ –ü–æ—Å–ª–µ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ
- ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤

### –ü–æ—á–µ–º—É –¥–æ–ª–≥–∞—è —Å–±–æ—Ä–∫–∞ –Ω–∞ Linux?

**SwiftPM 6.2 –Ω–∞ Linux –∑–∞–≤–∏—Å–∞–µ—Ç** –ø—Ä–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Å–±–æ—Ä–∫–∞—Ö:
- –ü—Ä–æ–±–ª–µ–º–∞: SQLite `build.db` —Å `busy_timeout=0` ‚Üí deadlock –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–±–æ—Ä–∫–∞—Ö
- –ü–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å: ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ `build.db`, ‚ùå `purge-cache` –±–µ–∑ `reset`
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ `purge-cache + reset`

**–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:**
- macOS: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ ~5-10 —Å–µ–∫ ‚úÖ
- Linux: –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ ~50-60 —Å–µ–∫ –∫–∞–∂–¥—ã–π —Ä–∞–∑ ‚ö†Ô∏è

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- Issue –≤ Swift: [–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è]
- Workaround: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `build-clean.sh` –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ SwiftPM

**TODO: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ Swift-DocC Preview
  - Verbose –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–µ –∏–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ
  - –í–æ–∑–º–æ–∂–Ω–æ: –æ—Ç–∫–ª—é—á–∏—Ç—å –ø–ª–∞–≥–∏–Ω—ã Swift-DocC –≤ Package.swift –≤—Ä–µ–º–µ–Ω–Ω–æ
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ–º–æ–≥–∞–µ—Ç –ª–∏ —Å–±–æ—Ä–∫–∞ –±–µ–∑ –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ—Å—Ç–∏

### –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–µ—Ç

–ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ "planning build" –∏–ª–∏ "Building for debugging...":

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à SwiftPM (–ø–æ–ø—Ä–æ–±—É–π —Å–Ω–∞—á–∞–ª–∞ —ç—Ç–æ)
swift package purge-cache && swift package reset

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç 1 –Ω–µ –ø–æ–º–æ–≥ ‚Üí –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./scripts/build-clean.sh
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í–∞—Ä–∏–∞–Ω—Ç 1 –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ macOS –∏ –∏–Ω–æ–≥–¥–∞ –Ω–∞ Linux. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥ - –∏—Å–ø–æ–ª—å–∑—É–π –≤–∞—Ä–∏–∞–Ω—Ç 2.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: tmux

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ SSH:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É –≤ tmux
tmux new-session -s build
./scripts/build-clean.sh

# –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è: Ctrl+B, –∑–∞—Ç–µ–º D
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è: tmux attach -t build
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ `.build/debug/tg-client` –∏–ª–∏ `.build/release/tg-client`
- –ò–∑–±–µ–≥–∞–π—Ç–µ –ª–∏—à–Ω–∏—Ö –ø–µ—Ä–µ—Å–±–æ—Ä–æ–∫ ‚Äî –µ—Å–ª–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∫–æ–¥ –Ω–µ –º–µ–Ω—è–ª—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é

**–°–±–æ—Ä–∫–∞ –≤ release —Ä–µ–∂–∏–º–µ**:
```bash
swift build -c release
```

–ë–∏–Ω–∞—Ä–Ω–∏–∫ –±—É–¥–µ—Ç –≤ `.build/release/tg-client`

## –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

```bash
source .env
swift run tg-client 2>/dev/null
```

–í–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è:
1. –í–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
2. –í–≤–µ—Å—Ç–∏ –∫–æ–¥ –∏–∑ SMS/Telegram
3. –í–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å 2FA (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–µ—Å—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `~/.tdlib/`

## –ó–∞–ø—É—Å–∫ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞/–æ—Ç–ª–∞–¥–∫–∞)

**–°–ø–æ—Å–æ–± –ê: –ó–∞–ø—É—Å–∫ —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç)**

```bash
# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫
export $(cat .env | xargs) && .build/debug/tg-client
```

**–°–ø–æ—Å–æ–± –ë: –ß–µ—Ä–µ–∑ swift run (—Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ ~1-2 –º–∏–Ω)**

```bash
source .env
swift run tg-client
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- `.build/debug/tg-client` - debug —Å–±–æ—Ä–∫–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `./scripts/build-clean.sh`)
- `.build/release/tg-client` - release —Å–±–æ—Ä–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç `swift build -c release`)
- `export $(cat .env | xargs)` - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env` —Ñ–∞–π–ª–∞ –≤ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
- Debug —Å–±–æ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª—å—à–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, release - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å stderr –≤ —Ñ–∞–π–ª (–æ—à–∏–±–∫–∏ + –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
export $(cat .env | xargs) && .build/debug/tg-client 2>app.log

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f app.log
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ systemd (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

–°–æ–∑–¥–∞–π—Ç–µ systemd service:

```bash
sudo tee /etc/systemd/system/tg-client.service > /dev/null << 'EOF'
[Unit]
Description=Telegram Client Service
After=network.target

[Service]
Type=simple
User=<your-username>
WorkingDirectory=/home/<your-username>/tg-client
Environment="TELEGRAM_API_ID=REDACTED_API_ID"
Environment="TELEGRAM_API_HASH=REDACTED_API_HASH"
Environment="TDLIB_STATE_DIR=/home/<your-username>/.tdlib"
Environment="PKG_CONFIG_PATH=/usr/lib/pkgconfig"
ExecStart=/home/<your-username>/tg-client/.build/release/tg-client
Restart=on-failure
RestartSec=10
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF
```

–ó–∞–º–µ–Ω–∏—Ç–µ `<your-username>` –Ω–∞ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!

–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:

```bash
sudo systemctl daemon-reload
sudo systemctl enable tg-client
sudo systemctl start tg-client

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status tg-client

# –õ–æ–≥–∏
sudo journalctl -u tg-client -f
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd ~/tg-client
git pull
source .env
swift build -c release
sudo systemctl restart tg-client  # –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ systemd
```

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ TDLib

```bash
pkg-config --modversion tdjson
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ TDLib

```bash
tail -100 ~/.tdlib/tdlib.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
tail -100 app.log
# –∏–ª–∏ –¥–ª—è systemd
sudo journalctl -u tg-client -n 100
```

### –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö)

```bash
rm -rf ~/.tdlib
# –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è!
```

## –†–∞–∑–ª–∏—á–∏—è macOS vs Linux

| –ê—Å–ø–µ–∫—Ç | macOS | Linux |
|--------|-------|-------|
| TDLib —É—Å—Ç–∞–Ω–æ–≤–∫–∞ | `brew install tdlib` | `apt install libtdjson-dev` |
| pkg-config –ø—É—Ç—å | `/opt/homebrew/opt/tdlib/lib/pkgconfig` | `/usr/lib/pkgconfig` |
| Swift —É—Å—Ç–∞–Ω–æ–≤–∫–∞ | Xcode | –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ tar.gz |
| Systemd | ‚ùå | ‚úÖ |
| Homebrew | ‚úÖ | ‚ùå |

## GitHub Actions CI

### –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ workflow

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∫–∞–∂–¥—ã–π push/PR –≤ –≤–µ—Ç–∫—É `main`:

- **Workflow**: `.github/workflows/linux-build.yml`
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Ubuntu 24.04
- **Swift**: 6.2
- **TDLib**: —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ (1.8.29)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –ø—Ä–æ–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

CI **–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ:
- `.claude/**` - –≤—Å—è –ø–∞–ø–∫–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- `*.md` - markdown —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ (README.md, CLAUDE.md –∏ —Ç.–¥.)
- `.claude/**` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Claude Code

CI **–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏:
- `Sources/**`, `Tests/**` - –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
- `Package.swift`, `Package.resolved` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `.github/workflows/**` - —Å–∞–º workflow

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:

**1. Swift toolchain** (–∫—ç—à –∫–ª—é—á: `swift-6.2-ubuntu24.04`)
- –ö—ç—à–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Swift (~500MB)
- –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–∏ Swift

**2. TDLib build** (–∫—ç—à –∫–ª—é—á: `tdlib-1.8.29-ubuntu24.04-release`)
- –ö—ç—à–∏—Ä—É–µ—Ç—Å—è —Å–æ–±—Ä–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ TDLib (~50MB)
- **–ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞**: ~25-30 –º–∏–Ω—É—Ç (–∫–æ–º–ø–∏–ª—è—Ü–∏—è TDLib –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤)
- **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–±–æ—Ä–∫–∏**: ~2-3 –º–∏–Ω—É—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à)
- –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–∏ TDLib –≤ –∫–ª—é—á–µ –∫—ç—à–∞

**‚ö†Ô∏è –í–ê–ñ–ù–û: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–∞ –∫—ç—à–∞**

–ö–ª—é—á –∫—ç—à–∞ **–ù–ï –¥–æ–ª–∂–µ–Ω –∑–∞–≤–∏—Å–µ—Ç—å** –æ—Ç –∏–∑–º–µ–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (workflow, Package.swift –∏ —Ç.–¥.):

```yaml
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∫—ç—à —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ workflow
key: tdlib-ubuntu24.04-${{ hashFiles('.github/workflows/linux-build.yml') }}

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á —Å –≤–µ—Ä—Å–∏–µ–π
key: tdlib-1.8.29-ubuntu24.04-release
```

–ï—Å–ª–∏ –∫–ª—é—á —Å–æ–¥–µ—Ä–∂–∏—Ç `hashFiles()` –Ω–∞ –∏–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã, –∫–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å TDLib –∑–∞–Ω–æ–≤–æ (30 –º–∏–Ω—É—Ç).

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ TDLib

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å TDLib –Ω–∞ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é:

1. –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è):
   ```bash
   git clone --branch v1.8.30 https://github.com/tdlib/td.git /tmp/td
   ```

2. –û–±–Ω–æ–≤–∏—Ç—å –∫–ª—é—á –∫—ç—à–∞:
   ```yaml
   key: tdlib-1.8.30-ubuntu24.04-release
   ```

3. –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞ —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π –∑–∞–π–º—ë—Ç ~30 –º–∏–Ω—É—Ç, –∑–∞—Ç–µ–º –±—É–¥–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è

### –¢–∞–π–º-–∞—É—Ç—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- **Build timeout**: 5 –º–∏–Ω—É—Ç (–¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∑–∞–≤–∏—Å–∞–Ω–∏–π SwiftPM)
- **Test timeout**: 5 –º–∏–Ω—É—Ç
- **–û—á–∏—Å—Ç–∫–∞ .build**: –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Å–±–æ—Ä–∫–æ–π (workaround –¥–ª—è SwiftPM hangs)
- **–í—ã–≤–æ–¥ –ª–æ–≥–æ–≤**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —á–µ—Ä–µ–∑ `tail -50` / `head -100` –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ push

```bash
# –°–∏–º—É–ª—è—Ü–∏—è CI –æ–∫—Ä—É–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
rm -rf .build
swift build 2>&1 | tail -20
swift test --skip TgClientE2ETests 2>&1 | head -50
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ CI

```bash
# –ß–µ—Ä–µ–∑ GitHub CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
gh run list --limit 5
gh run view <run-id> --log

# –ò–ª–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
https://github.com/<owner>/<repo>/actions
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ** `.env` —Ñ–∞–π–ª –≤ git!
2. **–ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ** –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `.tdlib/` - —Ç–∞–º —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å–µ—Å—Å–∏—è
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ .env: `chmod 600 .env`
4. –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ secrets management (Vault, AWS Secrets Manager, etc.)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ cron

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab -e
*/5 * * * * systemctl is-active --quiet tg-client || systemctl restart tg-client
```

### –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏

```bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
# –î–æ–±–∞–≤–∏—Ç—å –≤ ExecStartPre –≤ systemd:
ExecStartPre=/usr/bin/curl -s "https://api.telegram.org/bot<BOT_TOKEN>/sendMessage?chat_id=<CHAT_ID>&text=TG-Client restarting"
```
