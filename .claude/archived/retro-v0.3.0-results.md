# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤—ã v0.3.0

**–î–∞—Ç–∞:** 2025-12-10
**–ü–µ—Ä–∏–æ–¥:** 2025-12-06 ‚Üí 2025-12-08 (3 –¥–Ω—è)
**–†–µ–ª–∏–∑:** [v0.3.0](https://github.com/flyer2001/tg-client/releases/tag/v0.3.0)

---

## üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–µ—Ç—Ä–æ (2024-11 + 2025-12-05)

### –ì–∏–ø–æ—Ç–µ–∑–∞ 1.2: "Mock —Ç–æ–ª—å–∫–æ boundaries (FFI)" ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê

**–ò–∑ —Ä–µ—Ç—Ä–æ 2024-11:**
> –ï—Å–ª–∏ –º–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ FFI, Mock –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ Real.

**–ú–µ—Ç—Ä–∏–∫–∞:** Mock —Å—Ç–∞–±–∏–ª–µ–Ω 3+ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–¥—Ä—è–¥

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ v0.3.0:**
- ‚úÖ MockTDLibFFI: 0 –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Å—Ç–∞–±–∏–ª–µ–Ω —Å 2024-11)
- ‚úÖ MockHTTPClient: 40 —Å—Ç—Ä–æ–∫, –ø—Ä–∞–≤–∏–ª–æ —Å–æ–±–ª—é–¥–µ–Ω–æ
- ‚úÖ TDLibClient —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–ª—Å—è 3+ —Ä–∞–∑–∞ ‚Üí 0 –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Mock
- **–¶–µ–ª–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç**

**–ù–û: –ü—Ä–æ—Ü–µ—Å—Å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**
- ‚ùå Claude –ø—Ä–µ–¥–ª–æ–∂–∏–ª MockSummaryGenerator (v0.3.0) ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–∏–ª
- –ü—Ä–∞–≤–∏–ª–æ –≤ TESTING.md —Å—Ç—Ä–æ–∫–∞ 37, –Ω–æ **–ù–ï –≤ "–ö—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª–∞—Ö"** (—Å—Ç—Ä–æ–∫–∏ 7-15)

**–í—ã–≤–æ–¥:** –ì–∏–ø–æ—Ç–µ–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, Mock'–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã. –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ: –ø—Ä–∞–≤–∏–ª–æ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ (–ø—Ä–∏–Ω—è—Ç–æ 2025-12-10):**

–ö–æ–º–±–∏–Ω–∞—Ü–∏—è —É—Å–∏–ª–µ–Ω–∏–π –≤ 3 –º–µ—Å—Ç–∞—Ö:

1. **TESTING.md** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤ "–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞" (—Å—Ç—Ä–æ–∫–∏ 10-12):
   ```markdown
   6. **Mock —Ç–æ–ª—å–∫–æ boundaries** ‚Äî FFI/network/filesystem, –ù–ï internal logic
   ```

2. **ROLES.md** ‚Äî —á–µ–∫–ª–∏—Å—Ç –¥–ª—è Testing Architect:
   ```markdown
   **–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º Mock*.swift:**
   - [ ] –°–¢–û–ü: —ç—Ç–æ boundary (FFI/network/filesystem)?
   - [ ] –ï—Å–ª–∏ –î–ê ‚Üí —Å–æ–∑–¥–∞—ë–º Mock
   - [ ] –ï—Å–ª–∏ –ù–ï–¢ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º Real –≤ —Ç–µ—Å—Ç–∞—Ö
   ```

3. **/.claude/commands/endsession.md** ‚Äî —É—Å–∏–ª–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–æ–º–ø—Ç–∞ (—Å–µ–∫—Ü–∏—è 5):
   - –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–∞: —á–∏—Ç–∞—Ç—å ROLES.md, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–ª—å, –≤–∫–ª—é—á–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —á–µ–∫–ª–∏—Å—Ç—ã
   - –ü—Ä–æ–º–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¢–ï–ö–°–¢–û–ú –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–Ω–µ —Ñ–∞–π–ª–æ–º)
   - –í–∫–ª—é—á–∞—Ç—å –í–ï–°–¨ –∫–æ–Ω—Ç–µ–∫—Å—Ç: —Ä–æ–ª—å + —Å—Ç–∞—Ç—É—Å + —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ + –∫—Ä–∏—Ç–∏—á–Ω–æ–µ

**–ö–∞–∫ —Å–ª–µ–¥–∏–º (–º–µ—Ç—Ä–∏–∫–∞ v0.4.0):**
- % –∑–∞–¥–∞—á —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–æ–±–ª—é–¥–∞—é—Ç –ø—Ä–∞–≤–∏–ª–æ ‚Üí –¶–µ–ª—å: 100%
- Trigger: —Å–æ–∑–¥–∞–Ω–∏–µ Mock*.swift ‚Üí –°–¢–û–ü ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ boundary

**–°—Ç–∞—Ç—É—Å:** –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è TODO (—Å–º. –Ω–∏–∂–µ)

---

### –ì–∏–ø–æ—Ç–µ–∑–∞ 1.4: "Thread Sanitizer (TSan)" ‚è≥ –ù–ï –ü–†–û–í–ï–†–ï–ù–ê

**–ò–∑ —Ä–µ—Ç—Ä–æ 2024-11:**
> –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TSan –≤ —Ç–µ—Å—Ç–∞—Ö, —Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–º race conditions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ –¥–µ–±–∞–≥–∞.

**–ú–µ—Ç—Ä–∏–∫–∞:** 0 race conditions –ø—Ä–æ–ø—É—â–µ–Ω—ã TSan –≤ —Å–ª–µ–¥—É—é—â–∏—Ö 5 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ v0.3.0:**
- ‚úÖ 205 —Ç–µ—Å—Ç–æ–≤ GREEN (–±–µ–∑ —è–≤–Ω–æ–≥–æ `--sanitize=thread`)
- ‚ö†Ô∏è **v0.3.0 –ë–ï–ó concurrency** ‚Äî —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ (OpenAI API, DigestOrchestrator)
- **–ì–∏–ø–æ—Ç–µ–∑–∞ –ù–ï —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å:** –Ω–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–µ—Ç actors, –Ω–µ—Ç TaskGroup

**–§–∞–∫—Ç—ã:**
- TSan **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω** –≤ Swift (–Ω—É–∂–Ω–æ `swift test --sanitize=thread`)
- –í v0.3.0: `swift test` –±–µ–∑ —Ñ–ª–∞–≥–∞ ‚Üí –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ race conditions

**–†–µ—à–µ–Ω–∏–µ (–ø—Ä–∏–Ω—è—Ç–æ 2025-12-10):**

1. **–î–æ–±–∞–≤–∏—Ç—å –≤ –±—ç–∫–ª–æ–≥ v0.4.0: TSan —É—á–µ–Ω–∏—è**
   - –¶–µ–ª—å: —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–ª–æ—Ö–æ–π –∫–æ–¥ (race condition, deadlock, livelock)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ TSan –ª–æ–≤–∏—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã
   - –ü–æ–ª—É—á–∏—Ç—å –¥–æ–≤–µ—Ä–∏–µ –∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É

2. **Pre-release checklist:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å `swift test --sanitize=thread` –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ä–µ–ª–∏–∑–æ–º
   - –í–∫–ª—é—á–∏—Ç—å TSan –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å concurrency)

3. **–ü–µ—Ä–≤—ã–π concurrency –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: v0.4.0 (mark-as-read)**
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ—Ç–º–µ—Ç–∫–∞ —á–∞—Ç–æ–≤ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏
   - TSan –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

**–ö–∞–∫ —Å–ª–µ–¥–∏–º:**
- –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ "–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞" –ü–û–°–õ–ï:
  - –£—á–µ–Ω–∏–π —Å TSan (–æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ race condition –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –∫–æ–¥–µ)
  - –ò–õ–ò –æ—Ç–ª–æ–≤–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–≥–∞ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º –±–ª–∞–≥–æ–¥–∞—Ä—è TSan

**–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–æ–∂–µ–Ω–æ –¥–æ v0.4.0

---

### –ì–∏–ø–æ—Ç–µ–∑–∞ 1.3: "Overnight Pause" (Code Review) ‚è≥ –ù–ï –ü–†–û–í–ï–†–ï–ù–ê

**–ò–∑ —Ä–µ—Ç—Ä–æ 2024-11:**
> –ï—Å–ª–∏ –¥–µ–ª–∞—Ç—å –ø–∞—É–∑—É –º–µ–∂–¥—É –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º –∏ merge –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–º –ø—Ä–æ–±–ª–µ–º—ã —á–µ—Ä–µ–∑ "—Å–≤–µ–∂–∏–π –≤–∑–≥–ª—è–¥".

**–ú–µ—Ç—Ä–∏–∫–∞:** 1+ –∫—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞ –î–û production

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ v0.3.0:**
- ‚ö†Ô∏è v0.3.0 –∏–º–µ–ª –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (OpenAI API, DigestOrchestrator, —Å–ª–æ–∂–Ω—ã–π –±–∞–≥—Ñ–∏–∫—Å –∞—Ä—Ö–∏–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤)
- ‚ùå Overnight pause **–ù–ï –ø—Ä–∏–º–µ–Ω—è–ª—Å—è** —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ Manual E2E –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º –æ–±–Ω–∞—Ä—É–∂–∏–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥ (–∞—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã)
- **–ì–∏–ø–æ—Ç–µ–∑–∞ –ù–ï —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å:** –Ω–µ—Ç —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ overnight review

**–†–µ—à–µ–Ω–∏–µ (–ø—Ä–∏–Ω—è—Ç–æ 2025-12-10):**

**–ù–æ–≤–∞—è —Ä–æ–ª—å: Senior Code Reviewer** (–¥–æ–±–∞–≤–∏—Ç—å –≤ ROLES.md)

–ß–µ–∫–ª–∏—Å—Ç –¥–ª—è code review (–≤—á–µ—Ä–∞—à–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã):

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å:**
   - [ ] –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ä—ã (retain cycles, unowned/weak)
   - [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (uncaught throws, force unwrap)
   - [ ] –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫—Ä–∞—à–∞ (index out of bounds, division by zero)
   - [ ] –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (unbounded loops, memory growth)

2. **–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:**
   - [ ] –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
   - [ ] –ö—Ä–∞–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (empty, nil, boundary values)
   - [ ] –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–∑–ª–∏—à–Ω—è—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è)

3. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**
   - [ ] Code style (Swift API Design Guidelines)
   - [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ (–±–µ–∑ –∏–∑–ª–∏—à–Ω–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —É—Å—Ç–∞—Ä–µ—Ç—å)
   - [ ] –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ (–ø–æ–Ω—è—Ç–Ω–æ –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤)

4. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–∏—Å–∫–∏:**
   - [ ] –ù–∞—Ä—É—à–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü –º–æ–¥—É–ª–µ–π
   - [ ] –°–∫—Ä—ã—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (global state, singletons)
   - [ ] Concurrency –ø—Ä–æ–±–ª–µ–º—ã (shared mutable state)

**–ü—Ä–∞–≤–∏–ª–æ –¥–ª—è CLAUDE.md:**
```markdown
### –ü–µ—Ä–≤–∞—è —Å–µ—Å—Å–∏—è –∑–∞ –¥–µ–Ω—å:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `git log --since="yesterday" --oneline`
2. –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–º–º–∏—Ç—ã –∑–∞ –≤—á–µ—Ä–∞ ‚Üí –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å code review
3. –†–æ–ª—å: Senior Code Reviewer (ROLES.md)
4. –ß–µ–∫–ª–∏—Å—Ç: –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —Ç–µ—Å—Ç—ã, code style, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```

**–ö–∞–∫ —Å–ª–µ–¥–∏–º:**
- –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ "–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞" –ü–û–°–õ–ï:
  - Code review –æ–±–Ω–∞—Ä—É–∂–∏–ª –∫—Ä–∏—Ç–∏—á–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –î–û production
  - –ò–õ–ò 5+ reviews –ø—Ä–æ—à–ª–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –Ω–∞—Ö–æ–¥–æ–∫ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

**–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–æ–∂–µ–Ω–æ –¥–æ v0.4.0 (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–ª–∏ + –ø—Ä–∞–≤–∏–ª–∞ –≤ CLAUDE.md)

---

### –ì–∏–ø–æ—Ç–µ–∑—ã 1.1, 1.4, 1.5: "Concurrency-Aware Architecture" ‚è≥ –ù–ï –ü–†–û–í–ï–†–ï–ù–ê

**–û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ –∏–∑ —Ä–µ—Ç—Ä–æ 2024-11:**
> –ï—Å–ª–∏ –¥–µ–ª–∞—Ç—å Architecture-First –∞–Ω–∞–ª–∏–∑ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å concurrency/external API + –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TSan + —è–≤–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã Sequential ‚Üí Parallel, —Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —ç—Ç–∞–ø–µ design (–Ω–µ –ø–æ—Å–ª–µ 50+ –∫–æ–º–º–∏—Ç–æ–≤).

**–ò—Å—Ö–æ–¥–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã:**
- **1.1:** Architecture-First –¥–ª—è Concurrency –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **1.4:** Thread Sanitizer (TSan) –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç race conditions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **1.5:** –Ø–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ "Sequential ‚Üí Parallel" –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ v0.3.0:**
- ‚ö†Ô∏è v0.3.0 **–ë–ï–ó concurrency** (—Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥)
- **–ì–∏–ø–æ—Ç–µ–∑–∞ –ù–ï —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å:** –Ω–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ (–ø—Ä–∏–Ω—è—Ç–æ 2025-12-10):**

**1. –£—Å–∏–ª–∏—Ç—å —Ä–æ–ª—å Senior Swift Architect –≤ ROLES.md:**

–†–∞—Å—à–∏—Ä–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç "–ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π" —Å 4 –¥–æ 7 –±–ª–æ–∫–æ–≤:

```markdown
**–ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–æ 7 –±–ª–æ–∫–∞–º:**

1. **Concurrency –º–æ–¥–µ–ª—å:**
   - [ ] Sequential –∏–ª–∏ Parallel? (–µ—Å–ª–∏ N > 1 –æ–ø–µ—Ä–∞—Ü–∏–π)
   - [ ] –ü–µ—Ä–µ—Ö–æ–¥—ã: Parallel ‚Üí Sequential? (sync point, join)
   - [ ] Thread-safety: shared mutable state? Race conditions?
   - [ ] Deadlock —Ä–∏—Å–∫–∏: actor re-entrancy? Circular dependencies?

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - [ ] N –æ–ø–µ—Ä–∞—Ü–∏–π ‚Üí –Ω—É–∂–µ–Ω TaskGroup? (–µ—Å–ª–∏ N > 5 –∏ I/O)
   - [ ] Bottleneck: sequential –æ–ø–µ—Ä–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å pipeline?
   - [ ] –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API: rate limits? Backpressure?

3. **–ü–∞–º—è—Ç—å:**
   - [ ] –ú–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö ‚Üí –ø–∞–≥–∏–Ω–∞—Ü–∏—è/streaming?
   - [ ] Unbounded growth: accumulating results –≤ –ø–∞–º—è—Ç–∏?

4. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:**
   - [ ] Partial failure ‚Üí fail-fast –∏–ª–∏ partial success?
   - [ ] Retry —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: exponential backoff? Max attempts?
   - [ ] Timeout: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∞–Ω–∏–π
   - [ ] Graceful degradation: fallback –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ?

5. **Pipeline integration:**
   - [ ] –ú–µ—Å—Ç–æ –≤ –æ–±—â–µ–º pipeline (–ø–µ—Ä–µ–¥ —á–µ–º? –ø–æ—Å–ª–µ —á–µ–≥–æ?)
   - [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –æ–∂–∏–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç—Ç–∞–ø–∞?
   - [ ] –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: —á—Ç–æ –Ω—É–∂–Ω–æ –æ—Ç upstream? –ß—Ç–æ –ø–µ—Ä–µ–¥–∞—ë–º downstream?
   - [ ] Parallel ‚Üí Sequential –ø–µ—Ä–µ—Ö–æ–¥: –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?

6. **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å:**
   - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –Ω–∞—á–∞–ª–æ, –æ—à–∏–±–∫–∏, –∏—Ç–æ–≥ (count + duration)
   - [ ] –ú–µ—Ç—Ä–∏–∫–∏: latency, throughput, error rate
   - [ ] Debugging: –∫–∞–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É?

7. **Testing —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
   - [ ] TSan –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è concurrency –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - [ ] Edge cases: empty input, timeout, cancellation
   - [ ] Integration: –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–æ—Å—Ç–∞–≤–µ pipeline?
```

**2. –ü—Ä–∞–≤–∏–ª–æ –¥–ª—è CLAUDE.md:**

```markdown
### –ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
1. **–†–æ–ª—å: Senior Swift Architect** (ROLES.md)
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å ARCHITECTURE.md (–ø–∞—Ç—Ç–µ—Ä–Ω—ã concurrency, pipeline orchestration)
3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:** –ß–µ–∫–ª–∏—Å—Ç 7 –±–ª–æ–∫–æ–≤ (concurrency, performance, resilience, pipeline)
4. –ï—Å–ª–∏ concurrency ‚Üí TSan –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤ —Ç–µ—Å—Ç–∞—Ö
5. RFC/–ø–ª–∞–Ω ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```

**3. –ö–æ–Ω—Ç–µ–∫—Å—Ç pipeline orchestration:**

–¢–µ–∫—É—â–∏–π pipeline (MVP + v0.4.0):
```
[TDLib: loadChats] ‚Üí Sequential
    ‚Üì
[MessageSource: fetch messages] ‚Üí Parallel (N chats)
    ‚Üì (sync point: join)
[SummaryGenerator: create summary] ‚Üí Sequential (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∫ AI)
    ‚Üì
[Mark as read] ‚Üí Parallel (N chats) ‚Üê v0.4.0
    ‚Üì (sync point: join)
[BotNotifier: send digest] ‚Üí Sequential
```

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã:**
- Parallel ‚Üí Sequential (join): –≤—Å–µ —á–∞—Ç—ã ‚Üí –æ–¥–∏–Ω summary
- Sequential ‚Üí Parallel: summary –≥–æ—Ç–æ–≤ ‚Üí mark N chats as read
- Partial failure: 1 chat failed ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–ª–∏ fail-fast?

**–†–∏—Å–∫–∏:**
- **Retry –±–µ–∑ timeout** ‚Üí –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∑–∞–≤–∏—Å–∞–Ω–∏–µ pipeline
- **Unbounded parallelism** ‚Üí –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ TDLib API (rate limit)
- **Deadlock** –ø—Ä–∏ actor re-entrancy (DigestOrchestrator –∂–¥—ë—Ç MessageSource –∂–¥—ë—Ç TDLib)

**4. –ü–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã (v0.4.0):**

1. **TSan —É—á–µ–Ω–∏—è** (BACKLOG.md) ‚Üí –¥–æ–≤–µ—Ä–∏–µ –∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É
2. **mark-as-read –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:**
   - Architecture-First –∞–Ω–∞–ª–∏–∑ (7 –±–ª–æ–∫–æ–≤)
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ—Ç–º–µ—Ç–∫–∞ N —á–∞—Ç–æ–≤
   - Timeout + retry —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
   - TSan –≤ —Ç–µ—Å—Ç–∞—Ö
3. **–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:**
   - 0 —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–æ–≤ –∏–∑-–∑–∞ concurrency –æ—à–∏–±–æ–∫
   - TSan –æ–±–Ω–∞—Ä—É–∂–∏–ª –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —ç—Ç–∞–ø–µ —Ç–µ—Å—Ç–æ–≤ (–Ω–µ –≤ production)
   - Pipeline integration —Ä–∞–±–æ—Ç–∞–µ—Ç (parallel ‚Üí sequential ‚Üí parallel)

**–ö–∞–∫ —Å–ª–µ–¥–∏–º:**
- –ì–∏–ø–æ—Ç–µ–∑–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ "–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞" –ü–û–°–õ–ï v0.4.0:
  - –ß–µ–∫–ª–∏—Å—Ç 7 –±–ª–æ–∫–æ–≤ –ø—Ä–∏–º–µ–Ω—ë–Ω –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
  - TSan —É—á–µ–Ω–∏—è –ø—Ä–æ–π–¥–µ–Ω—ã (3/3 –æ—à–∏–±–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã)
  - mark-as-read –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ concurrency –±–∞–≥–æ–≤

**–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–æ–∂–µ–Ω–æ –¥–æ v0.4.0 (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ–∫–ª–∏—Å—Ç–∞ + TSan —É—á–µ–Ω–∏—è + –ø–µ—Ä–≤—ã–π concurrency –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ v0.3.0

### –ö–æ–¥:
- **–¢–µ—Å—Ç—ã:** 146 ‚Üí 205 (+59 —Ç–µ—Å—Ç–æ–≤, +40%)
  - OpenAISummaryGenerator: 7 Unit tests
  - DigestOrchestrator: 6 Component tests
  - ChannelMessageSource bugfix: +2 regression tests
  - ChatList/ChatPosition models: 11 + 13 + 6 = 30 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏:** OpenAISummaryGenerator, DigestOrchestrator
- **–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:** 11 (Sources + Tests)
- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** ~25
- **–ö–æ–º–º–∏—Ç—ã:** 16 (11 features + 4 docs + 1 bugfix)

### –ë–∞–≥–∏:
- **–ù–∞–π–¥–µ–Ω–æ –¥–æ —Ä–µ–ª–∏–∑–∞:** 2
  1. FoundationNetworking import –Ω–∞ macOS (–±—ã—Å—Ç—Ä–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
  2. üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π:** –ê—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∞–π–¥–∂–µ—Å—Ç
- **–ù–∞–π–¥–µ–Ω–æ –ø–æ—Å–ª–µ —Ä–µ–ª–∏–∑–∞:** 0
- **–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω–æ:** 2

### –ü—Ä–æ—Ü–µ—Å—Å:
- **Research-First –ø—Ä–∏–º–µ–Ω—ë–Ω:** 2/3 (66%)
  - ‚úÖ OpenAI API (spike –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π)
  - ‚úÖ getChatHistory offset (live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã)
  - ‚ùå TDLib updateChatPosition (–ø—Ä–æ–ø—É—â–µ–Ω ‚Üí **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥**)
- **TDD —Ü–∏–∫–ª—ã:** 6 (OpenAISummaryGenerator, DigestOrchestrator, 3 bugfix, ChatPosition models)
- **Outside-In –ø—Ä–∞–≤–∏–ª—å–Ω–æ:** 6/6 (100%)

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:
- **TSan:** 205 —Ç–µ—Å—Ç–æ–≤ GREEN, 0 data races ‚úÖ
- **Cross-platform:** macOS + Linux —Å–±–æ—Ä–∫–∏ —É—Å–ø–µ—à–Ω—ã ‚úÖ
- **E2E manual test:** 6 –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö ‚Üí 952 —Å–∏–º–≤–æ–ª–∞ –∑–∞ ~10 —Å–µ–∫ ‚úÖ

### Time tracking (–ø—Ä–∏–º–µ—Ä–Ω–æ):
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ v0.3.0:** ~12 —á–∞—Å–æ–≤ (OpenAI + DigestOrchestrator + —Ç–µ—Å—Ç—ã)
- **–ë–∞–≥—Ñ–∏–∫—Å (–∞—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã):** ~8 —á–∞—Å–æ–≤ (research + fix + regression tests)
- **–î–æ–ª—è –±–∞–≥—Ñ–∏–∫—Å–æ–≤:** 40% –≤—Ä–µ–º–µ–Ω–∏ üî¥
- **SwiftPM debugging:** ~6 —á–∞—Å–æ–≤ (strace + lldb + community response)

---

## üîç –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

### 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤–º–µ—Å—Ç–æ –º–æ–∫–∞ (–ü–û–í–¢–û–†–ù–´–ô –∏–Ω—Ü–∏–¥–µ–Ω—Ç)

**Status:** ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

**Root Cause:**
- –ü—Ä–∞–≤–∏–ª–æ "Mock —Ç–æ–ª—å–∫–æ boundaries" –±—ã–ª–æ –≤ TESTING.md (–ø–æ—Å–ª–µ —Ä–µ—Ç—Ä–æ 2024-11)
- Claude **–ù–ï –ø—Ä–∏–º–µ–Ω–∏–ª –ø—Ä–∞–≤–∏–ª–æ** –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ DigestOrchestrator —Ç–µ—Å—Ç–æ–≤
- –ü—Ä–µ–¥–ª–æ–∂–∏–ª —Å–æ–∑–¥–∞—Ç—å MockSummaryGenerator (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–∏–ª –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ê–Ω–∞–ª–∏–∑ –≥–∏–ø–æ—Ç–µ–∑:**

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 1:** –ù–µ –ø–µ—Ä–µ—á–∏—Ç–∞–ª TESTING.md –ø–µ—Ä–µ–¥ –∑–∞–¥–∞—á–µ–π
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** ROLES.md —É–∫–∞–∑—ã–≤–∞–µ—Ç —á–∏—Ç–∞—Ç—å TESTING.md –¥–ª—è "–ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤", –Ω–æ —ç—Ç–æ –Ω–µ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 2:** –ù—É–∂–µ–Ω —è–≤–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –≤ ROLES.md
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** –ß–µ–∫–ª–∏—Å—Ç –µ—Å—Ç—å (—Ä–∞–∑–¥–µ–ª "–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞"), –Ω–æ –Ω–µ –±—ã–ª –ø—Ä–∏–º–µ–Ω—ë–Ω

‚ö†Ô∏è **–ì–∏–ø–æ—Ç–µ–∑–∞ 3:** –°—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–º–ø—Ç "–ü—Ä–æ–≤–µ—Ä—å: –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—à—å –ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª"
‚Üí **–ß–∞—Å—Ç–∏—á–Ω–æ:** –ü—Ä–∞–≤–∏–ª–æ –µ—Å—Ç—å, –Ω–æ –Ω—É–∂–Ω–æ –ø–æ–≤—ã—à–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–≤ –Ω–∞—á–∞–ª–æ TESTING.md)

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ù–∞—Ä—É—à–µ–Ω–∏—è "Mock —Ç–æ–ª—å–∫–æ boundaries": 1/1 –∑–∞–¥–∞—á —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (100% üî¥)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–π–º–∞–ª: 1/1 (100% ‚úÖ) ‚Äî –ø—Ä–æ—Ü–µ—Å—Å review —Ä–∞–±–æ—Ç–∞–µ—Ç!

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [x] –ü—Ä–∞–≤–∏–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ TESTING.md (2025-12-05)
- [x] –°—Å—ã–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ ROLES.md (Testing Architect)
- [ ] TODO: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "Mock —Ç–æ–ª—å–∫–æ boundaries" –≤ **–ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫** TESTING.md

---

### 2. –ë–∞–≥ —Å –∞—Ä—Ö–∏–≤–Ω—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)

**Status:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–æ —Ä–µ–ª–∏–∑–∞

**Root Cause:**
- **Research-First –ù–ï –ø—Ä–∏–º–µ–Ω—ë–Ω** –¥–ª—è TDLib `updateChatPosition`
- –ü–æ–ª–∞–≥–∞–ª–∏—Å—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä `chatList: .main` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- TDLib –ø—Ä–∏—Å—ã–ª–∞–µ—Ç `updateNewChat` **–ë–ï–ó** `positions` (–ø—É—Å—Ç–æ–µ –ø–æ–ª–µ)
- –†–µ–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –≤ `updateChatPosition`
- Mock **–ù–ï —ç–º—É–ª–∏—Ä–æ–≤–∞–ª** —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ)

**–ê–Ω–∞–ª–∏–∑ –≥–∏–ø–æ—Ç–µ–∑:**

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 1: Research-First –Ω–∞—Ä—É—à–µ–Ω**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** –ù–ï —á–∏—Ç–∞–ª–∏ WebFetch –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é updateChatPosition –¥–æ –±–∞–≥—Ñ–∏–∫—Å–∞

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 2: Component —Ç–µ—Å—Ç—ã —Å "—É–º–Ω—ã–º" Mock**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** MockTDLibFFI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –ù–ï –æ—Ç—Ä–∞–∂–∞–µ—Ç TDLib –ø—Ä–æ—Ç–æ–∫–æ–ª

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 3: –ù–µ—Ç manual test checklist**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** Manual E2E —Ç–µ—Å—Ç –±—ã–ª —Å–¥–µ–ª–∞–Ω, –Ω–æ **—Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º** (—Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ)

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 4: –ù–µ —Ö–≤–∞—Ç–∏–ª–æ –∫—Ä–∞–µ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** –ù–µ –±—ã–ª–æ —Ç–µ—Å—Ç–∞ "archived channel ‚Üí NOT included"

**–ú–µ—Ç—Ä–∏–∫–∏ Research-First:**
- External API –º–µ—Ç–æ–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 4 (loadChats, getChats, getChatHistory, updateChatPosition)
- –ü—Ä–æ—à–ª–∏ Research-First: 1/4 (25% üî¥)
  - ‚ùå loadChats ‚Äî –ø–æ–ª–∞–≥–∞–ª–∏—Å—å –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä, –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ behavior
  - ‚ùå updateChatPosition ‚Äî –Ω–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–ª–∏ –¥–æ –º–æ–º–µ–Ω—Ç–∞ –±–∞–≥–∞
  - ‚úÖ getChatHistory ‚Äî live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å–ø–∞—Å–ª–∏ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –±–∞–≥–∞
  - ‚ùå OpenAI API ‚Äî spike –±—ã–ª, –Ω–æ –Ω–µ —á–µ—Ä–µ–∑ WebFetch (shell script)

**–í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:**
- **Manual E2E:** —Å—Ä–∞–∑—É –æ–±–Ω–∞—Ä—É–∂–∏–ª (–≤ 1-–º –∑–∞–ø—É—Å–∫–µ)
- **Time to fix:** ~8 —á–∞—Å–æ–≤ (research + models + tests + fix)

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [x] Regression tests –¥–æ–±–∞–≤–ª–µ–Ω—ã (archived channel test)
- [x] Research-First –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ retro-questions.md
- [ ] TODO: –î–æ–±–∞–≤–∏—Ç—å **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç** –¥–ª—è External API –≤ TESTING.md:
  ```
  External API ‚Üí Research-First:
  1. WebFetch –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã + behaviour)
  2. Failing test —Å –∫—Ä–∞–µ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
  3. Live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç (–µ—Å–ª–∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–∞)
  4. –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
  ```

---

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞ –º–æ–¥–µ–ª–∏ (ChatList)

**Status:** ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º

**Root Cause:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `Glob` —Ç–æ–ª—å–∫–æ –¥–ª—è `**/TgClientModels/Models/*.swift` (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞!)
- –ù–ï —Å–¥–µ–ª–∞–ª `Grep` –ø–æ –≤—Å–µ–º—É –º–æ–¥—É–ª—é TgClientModels
- –°–æ–∑–¥–∞–ª –¥—É–±–ª–∏–∫–∞—Ç `enum ChatList` (—É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –≤ `LoadChatsRequest.swift`)
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º—ë–Ω –æ–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º

**–ê–Ω–∞–ª–∏–∑ –≥–∏–ø–æ—Ç–µ–∑:**

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 1: –ù–µ—Ç —è–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ "Grep –ø–µ—Ä–µ–¥ Write"**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** –í CLAUDE.md –Ω–µ—Ç —Å–µ–∫—Ü–∏–∏ "–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∏–ø–∞ ‚Üí Grep"

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 2: Glob –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, Glob –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É)

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 3: –ù—É–∂–µ–Ω —á–µ–∫–ª–∏—Å—Ç –≤ ROLES.md**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** Swift Developer —Ä–æ–ª—å –ù–ï –∏–º–µ–µ—Ç —á–µ–∫–ª–∏—Å—Ç–∞ "–ü—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã"

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –î—É–±–ª–∏–∫–∞—Ç—ã —Å–æ–∑–¥–∞–Ω—ã: 1/6 –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ (16%)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º: 1/1 (100% ‚Äî –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å–ø–∞—Å)
- Time to fix: ~15 –º–∏–Ω—É—Ç (—É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞ + —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [ ] TODO: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ CLAUDE.md:
  ```
  –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ (struct/enum/class):
  1. Grep "struct TypeName" + "enum TypeName" –≤ –º–æ–¥—É–ª–µ
  2. Grep "import.*TypeName" (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –¥—Ä—É–≥–æ–º –º–æ–¥—É–ª–µ)
  3. –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ NOT FOUND ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª
  ```
- [ ] TODO: –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è Swift Developer –≤ ROLES.md

---

### 4. Manual E2E –æ–±–Ω–∞—Ä—É–∂–∏–ª –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ order –∫–∞–∫ String

**Status:** ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å —Å—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**Root Cause:**
- TDLib –ø—Ä–∏—Å—ã–ª–∞–µ—Ç `order` –∫–∞–∫ **String** (—á–∏—Å–ª–∞ > 2^53), –Ω–µ –∫–∞–∫ JSON number
- –ú–æ–¥–µ–ª—å `ChatPosition` –æ–∂–∏–¥–∞–ª–∞ `Int64` –Ω–∞–ø—Ä—è–º—É—é ‚Üí decode failed
- **Manual E2E –ø–µ—Ä–µ–¥ Unit —Ç–µ—Å—Ç–∞–º–∏** –æ–±–Ω–∞—Ä—É–∂–∏–ª –ø—Ä–æ–±–ª–µ–º—É

**–ß—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ:**
- ‚úÖ –ü–ª–∞–Ω bugfix: "Fix ‚Üí E2E ‚Üí Unit ‚Üí Regression" (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ Manual E2E **–î–û** Unit —Ç–µ—Å—Ç–æ–≤ ‚Üí –∏–∑–±–µ–∂–∞–ª–∏ "–Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏"
- ‚úÖ WebFetch –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–ª —Ç–∏–ø—ã, –Ω–æ **–ù–ï —Ñ–æ—Ä–º–∞—Ç JSON**

**–ê–Ω–∞–ª–∏–∑ –≥–∏–ø–æ—Ç–µ–∑:**

‚ö†Ô∏è **–ì–∏–ø–æ—Ç–µ–∑–∞ 1: Unit —Ç–µ—Å—Ç –º–æ–¥–µ–ª–∏ –°–†–ê–ó–£ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è**
‚Üí **–ù–µ –Ω—É–∂–Ω–æ:** Manual E2E –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω, Unit test –ø—Ä–∏—à—ë–ª –ø–æ–∑–∂–µ (–®–∞–≥ 4)

‚úÖ **–ì–∏–ø–æ—Ç–µ–∑–∞ 2: Research-First –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å JSON –ø—Ä–∏–º–µ—Ä—ã**
‚Üí **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** WebFetch –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø—ã, –Ω–æ **–ù–ï —Ñ–æ—Ä–º–∞—Ç JSON** (String vs Number)

‚ö†Ô∏è **–ì–∏–ø–æ—Ç–µ–∑–∞ 3: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö JSON –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ debug –ª–æ–≥–æ–≤**
‚Üí **–ü–æ–ª–µ–∑–Ω–æ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ:** Manual E2E –ø–æ–∫—Ä—ã–ª gap

**–í—ã–≤–æ–¥:**
- **–¢–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç–∞–µ—Ç:** Manual E2E ‚Üí –æ–±–Ω–∞—Ä—É–∂–∏–ª –ø—Ä–æ–±–ª–µ–º—É ‚Üí –∏—Å–ø—Ä–∞–≤–∏–ª–∏ ‚Üí Unit tests
- **–£–ª—É—á—à–µ–Ω–∏–µ:** Research-First –¥–ª—è –º–æ–¥–µ–ª–µ–π = WebFetch docs + **debug –ª–æ–≥ —Å —Ä–µ–∞–ª—å–Ω—ã–º JSON** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

**Time to fix:** ~20 –º–∏–Ω—É—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ decodeInt64 helper + —Ç–µ—Å—Ç—ã)

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [x] Unit —Ç–µ—Å—Ç—ã –¥–ª—è ChatPosition —Å —Ä–µ–∞–ª—å–Ω—ã–º JSON (13 —Ç–µ—Å—Ç–æ–≤)
- [ ] TODO: –£—Ç–æ—á–Ω–∏—Ç—å –≤ TESTING.md:
  ```
  External API –º–æ–¥–µ–ª–∏:
  1. WebFetch docs (—Ç–∏–ø—ã –ø–æ–ª–µ–π)
  2. Manual E2E –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ JSON (debug –ª–æ–≥)
  3. Unit test –º–æ–¥–µ–ª–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º JSON (–ü–û–°–õ–ï E2E, –Ω–µ –î–û)
  ```

---

### 5. –ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ–±–∞–≥–∞

**Status:** ‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å–Ω–∞—è –æ—à–∏–±–∫–∞ (–ø–æ–π–º–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)

**Root Cause:**
- Claude –¥–æ–±–∞–≤–∏–ª DEBUG –ª–æ–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ `positions`
- –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–Ω–µ –ø–æ–∫–∞–∑–∞–ª –∞—Ä—Ö–∏–≤–Ω—ã—Ö) —Å—Ä–∞–∑—É –Ω–∞—á–∞–ª —É–±–∏—Ä–∞—Ç—å DEBUG
- –§—Ä–∞–∑–∞: "–î–∞–≤–∞–π —É–±–µ—Ä—É DEBUG –∏ –ø—Ä–æ–≤–µ—Ä–∏–º —á—Ç–æ BUGFIX –∑–∞–≤–µ—Ä—à—ë–Ω"
- **–ü—Ä–æ–±–ª–µ–º–∞:** "removed 0 archived" –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –¥–æ–ª–∂–Ω–æ –±—ã–ª–æ –Ω–∞—Å—Ç–æ—Ä–æ–∂–∏—Ç—å

**Lesson:**
- ‚ùå –ù–ï –∑–∞–≤–µ—Ä—à–∞—Ç—å –¥–µ–±–∞–≥ –ø–æ–∫–∞ –±–∞–≥ **–Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω –∏ –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω**
- ‚ùå "–¢–µ—Å—Ç—ã GREEN" ‚â† "–ë–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω" (–µ—Å–ª–∏ –±–∞–≥ –≤ production data)

**–¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**
1. "removed 0 archived" –ø—Ä–∏ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–µ ‚Üí **–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–µ–±–∞–≥**
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –±–∞–≥–∞ –≤ –ª–æ–≥–∞—Ö ‚Üí **—Ä–∞—Å—à–∏—Ä–∏—Ç—å DEBUG**
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É ‚Üí **–Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—Ç—å fix –±–µ–∑ proof**

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ü–æ–ø—ã—Ç–∫–∏ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: 1
- –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º: 1/1 (100% ‚úÖ)

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [ ] TODO: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ CLAUDE.md (—Å–µ–∫—Ü–∏—è "–ë–∞–≥-—Ñ–∏–∫—Å workflow"):
  ```
  –î–µ–±–∞–≥ –ù–ï –∑–∞–≤–µ—Ä—à—ë–Ω –ø–æ–∫–∞:
  - –ë–∞–≥ –ù–ï –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω –≤ –ª–æ–≥–∞—Ö/—Ç–µ—Å—Ç–∞—Ö
  - –§–∏–∫—Å –ù–ï –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞
  ```

---

### 6. Research-First —Å–ø–∞—Å –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ getChatHistory ‚úÖ

**Status:** ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –ø—Ä–∏–º–µ—Ä Research-First

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
- **v0.1.0:** –†–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ `getChatHistory` —Å —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π `offset=0, fromMessageId=0`
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—É—á–∞–ª–∏ –ü–û–°–õ–ï–î–ù–ò–ï —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- **v0.3.0:** –û–±–Ω–∞—Ä—É–∂–∏–ª–∏ –±–∞–≥ –ø—Ä–∏ manual E2E test

**–†–µ—à–µ–Ω–∏–µ v0.3.0 (Research-First) ‚úÖ:**
1. ‚úÖ –°–æ–∑–¥–∞–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª @aidigestcreator
2. ‚úÖ Live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å offset –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º TDLib
3. ‚úÖ WebFetch –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Å–µ–º–∞–Ω—Ç–∏–∫–∏
4. ‚úÖ –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏ –≤—ã–≤–æ–¥—ã: `offset=-N` ‚Üí N —Å–æ–æ–±—â–µ–Ω–∏–π –ü–û–°–õ–ï fromMessageId
5. ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å `lastReadInboxMessageId`:
   - `lastReadInboxMessageId=0` ‚Üí `(fromMessageId=0, offset=0)`
   - `lastReadInboxMessageId>0` ‚Üí `(fromMessageId=lastRead, offset=-N)`

**Lesson:**
- ‚úÖ **External API —Å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π ‚Üí Research-First –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**
- ‚úÖ **–ú–æ–∫–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ù–ï –ª–æ–≤—è—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ API**
- ‚úÖ **Live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã > –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + –º–æ–∫–∏**
- ‚ö†Ô∏è **–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ ‚â† –†–µ–∞–ª–∏–∑–∞—Ü–∏—è** (–Ω—É–∂–µ–Ω failing test –∫–∞–∫ —è–∫–æ—Ä—å)

**–ú–µ—Ç—Ä–∏–∫–∏:**
- External APIs —Å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π: 2 (getChatHistory, updateChatPosition)
- Research-First –ø—Ä–∏–º–µ–Ω—ë–Ω: 1/2 (50%)
  - ‚úÖ getChatHistory (v0.3.0 bugfix)
  - ‚ùå updateChatPosition (–ø—Ä–æ–ø—É—â–µ–Ω ‚Üí –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥)

**–ì–∏–ø–æ—Ç–µ–∑–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
> "Research-First –¥–ª—è External APIs —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ —Å 80% –¥–æ 10%"

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã:**
- –î–æ Research-First: 2 –±–∞–≥–∞ (getChatHistory v0.1.0, updateChatPosition v0.3.0) –∏–∑ 2 External APIs = **100% –æ—à–∏–±–æ–∫** üî¥
- –ü–æ—Å–ª–µ Research-First (getChatHistory v0.3.0): **0 –æ—à–∏–±–æ–∫** ‚úÖ
- **–ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞:** Research-First —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ **–¥–æ 0%** (–ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏)

**–î–µ–π—Å—Ç–≤–∏–µ:**
- [x] –ü—Ä–∞–≤–∏–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ retro-questions.md (–í–æ–ø—Ä–æ—Å 4)
- [ ] TODO: –§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ TESTING.md:
  ```
  External API —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (offset, pagination, cursor):
  1. Research-First –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (WebFetch + live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã)
  2. Failing test —Å –∫—Ä–∞–µ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
  3. Test = —è–∫–æ—Ä—å –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –∑–∞–¥–∞—á–µ (—Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –ø—Ä–æ–ø—É—Å–∫–∞ —Å 50% –¥–æ 5%)
  ```

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Research-First (–∫–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è):**
   - OpenAI API spike ‚Üí –∏–∑–±–µ–∂–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º —Å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - getChatHistory live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã ‚Üí –∏—Å–ø—Ä–∞–≤–∏–ª–∏ –ª–æ–≥–∏–∫—É v0.1.0
   - **–°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫ —Å 100% –¥–æ 0%**

2. **Outside-In TDD:**
   - 6/6 —Ü–∏–∫–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (100%)
   - Component test ‚Üí RED ‚Üí Unit test ‚Üí GREEN ‚Üí Refactor

3. **Manual E2E –ø–µ—Ä–µ–¥ Unit —Ç–µ—Å—Ç–∞–º–∏:**
   - –û–±–Ω–∞—Ä—É–∂–∏–ª –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ order –∫–∞–∫ String
   - –û–±–Ω–∞—Ä—É–∂–∏–ª –∞—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –≤ –¥–∞–π–¥–∂–µ—Å—Ç–µ
   - **–°–ø–∞—Å–∞–µ—Ç –æ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤**

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–∞–∫ reviewer:**
   - –û—Å—Ç–∞–Ω–æ–≤–∏–ª MockSummaryGenerator –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚úÖ
   - –û—Å—Ç–∞–Ω–æ–≤–∏–ª –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ–±–∞–≥–∞ ‚úÖ
   - **Culture —Ä–∞–±–æ—Ç–∞–µ—Ç!**

5. **Cross-platform —Å–±–æ—Ä–∫–∏ + TSan:**
   - 205 —Ç–µ—Å—Ç–æ–≤ GREEN –Ω–∞ macOS + Linux
   - 0 data races –≤ TSan
   - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è**

---

## ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Research-First –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - 1/4 External APIs –ø—Ä–æ—à–ª–∏ Research-First (25% üî¥)
   - –ü—Ä–∞–≤–∏–ª–æ –µ—Å—Ç—å –≤ TESTING.md, –Ω–æ **–ù–ï —á–∏—Ç–∞–µ—Ç—Å—è** –ø–µ—Ä–µ–¥ –∑–∞–¥–∞—á–µ–π
   - **Root cause:** TESTING.md —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π? –ü—Ä–∞–≤–∏–ª–æ –Ω–µ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞?

2. **"Mock —Ç–æ–ª—å–∫–æ boundaries" –Ω–∞—Ä—É—à–∞–µ—Ç—Å—è:**
   - 1/1 –∑–∞–¥–∞—á —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (100% üî¥)
   - –ü—Ä–∞–≤–∏–ª–æ –µ—Å—Ç—å, –Ω–æ **–ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è**
   - **Root cause:** –ß–µ–∫–ª–∏—Å—Ç –≤ ROLES.md –µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

3. **–ù–µ—Ç —á–µ–∫–ª–∏—Å—Ç–∞ "–ü—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã":**
   - 1/6 –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –±—ã–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ (16%)
   - Glob –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É**
   - **Root cause:** –ù–µ—Ç —è–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –≤ CLAUDE.md

4. **Manual E2E –¥–µ–ª–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ:**
   - –ê—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º
   - Manual E2E –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**, –Ω–µ –≤ –∫–æ–Ω—Ü–µ
   - **Root cause:** –ù–µ—Ç workflow "TDD ‚Üí Manual E2E ‚Üí Regression tests"

5. **–ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ–±–∞–≥–∞:**
   - 1 –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å –±–µ–∑ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –±–∞–≥–∞
   - "–¢–µ—Å—Ç—ã GREEN" ‚â† "–ë–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω"
   - **Root cause:** –ù–µ—Ç —è–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ "–ù–ï –∑–∞–≤–µ—Ä—à–∞—Ç—å –ø–æ–∫–∞ –±–∞–≥ –ù–ï –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω"

---

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

### 1. Research-First –¥–ª—è External APIs (–ö–†–ò–¢–ò–ß–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** 75% External APIs –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ Research-First ‚Üí –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥

**–†–µ—à–µ–Ω–∏–µ:**
- [x] –ü—Ä–∞–≤–∏–ª–æ —É–∂–µ –µ—Å—Ç—å –≤ TESTING.md (—Å–µ–∫—Ü–∏—è "Research-First –¥–ª—è External APIs")
- [ ] **TODO:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ **–ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫** TESTING.md
- [ ] **TODO:** –î–æ–±–∞–≤–∏—Ç—å –≤ CLAUDE.md (—Å–µ–∫—Ü–∏—è "Workflow –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏"):
  ```markdown
  ### –ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π External API:
  1. WebFetch –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã + behaviour + edge cases)
  2. Failing test —Å –∫—Ä–∞–µ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
  3. Live —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç (–µ—Å–ª–∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–∞: offset, pagination, async updates)
  4. –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
  ```

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:** 100% External APIs –ø—Ä–æ—Ö–æ–¥—è—Ç Research-First (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)

---

### 2. –ß–µ–∫–ª–∏—Å—Ç "–ü—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã" –ø–µ—Ä–µ–¥ Write

**–ü—Ä–æ–±–ª–µ–º–∞:** 16% –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –±—ã–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:**
- [ ] **TODO:** –î–æ–±–∞–≤–∏—Ç—å –≤ CLAUDE.md (—Å–µ–∫—Ü–∏—è "Workflow –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏"):
  ```markdown
  ### –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ (struct/enum/class):
  1. Grep –ø–æ –≤—Å–µ–º—É –º–æ–¥—É–ª—é: `pattern: "struct TypeName"`
  2. Grep –ø–æ –≤—Å–µ–º—É –º–æ–¥—É–ª—é: `pattern: "enum TypeName"`
  3. Grep –∏–º–ø–æ—Ä—Ç—ã: `pattern: "import.*TypeName"`
  4. –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ NOT FOUND ‚Üí —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª
  ```
- [ ] **TODO:** –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç –≤ ROLES.md (Swift Developer):
  ```markdown
  **–ü–µ—Ä–µ–¥ Write –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞:**
  - [ ] Grep —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã –≤ –º–æ–¥—É–ª–µ
  - [ ] Grep –∏–º–ø–æ—Ä—Ç—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
  - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞: —Ç–∏–ø –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  ```

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:** 0% –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)

---

### 3. "Mock —Ç–æ–ª—å–∫–æ boundaries" –≤ –Ω–∞—á–∞–ª–æ TESTING.md

**–ü—Ä–æ–±–ª–µ–º–∞:** 100% –∑–∞–¥–∞—á —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞—Ä—É—à–∏–ª–∏ –ø—Ä–∞–≤–∏–ª–æ

**–†–µ—à–µ–Ω–∏–µ:**
- [x] –ü—Ä–∞–≤–∏–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ TESTING.md (2025-12-05)
- [ ] **TODO:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ü—Ä–∞–≤–∏–ª–∞ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è" –≤ **–ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫** TESTING.md
- [ ] **TODO:** –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –≤ CLAUDE.md (—Å–µ–∫—Ü–∏—è "TDD Workflow"):
  ```markdown
  ### –ü—Ä–∞–≤–∏–ª–∞ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è (–ö–†–ò–¢–ò–ß–ù–û):
  - ‚úÖ Mock –¢–û–õ–¨–ö–û boundaries (FFI, network, filesystem)
  - ‚ùå –ù–ï —Å–æ–∑–¥–∞–≤–∞–π Mock –¥–ª—è internal implementation
  - –î–µ—Ç–∞–ª–∏: [TESTING.md#–ø—Ä–∞–≤–∏–ª–∞-–º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è]
  ```

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:** 0% –Ω–∞—Ä—É—à–µ–Ω–∏–π (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)

---

### 4. Workflow –¥–µ–±–∞–≥–∞: –ù–ï –∑–∞–≤–µ—Ä—à–∞—Ç—å –±–µ–∑ proof

**–ü—Ä–æ–±–ª–µ–º–∞:** 1 –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å –±–µ–∑ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
- [ ] **TODO:** –î–æ–±–∞–≤–∏—Ç—å –≤ CLAUDE.md (—Å–µ–∫—Ü–∏—è "–ë–∞–≥-—Ñ–∏–∫—Å workflow"):
  ```markdown
  ### –î–µ–±–∞–≥ –ù–ï –∑–∞–≤–µ—Ä—à—ë–Ω –ø–æ–∫–∞:
  1. –ë–∞–≥ –ù–ï –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω –≤ –ª–æ–≥–∞—Ö/—Ç–µ—Å—Ç–∞—Ö
  2. –§–∏–∫—Å –ù–ï –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

  –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –¥–µ–±–∞–≥–∞:
  - "removed 0 X" –ø—Ä–∏ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–µ —Å X
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è
  ```

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:** 0 –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)

---

### 5. Manual E2E –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–Ω–µ –≤ –∫–æ–Ω—Ü–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
- [ ] **TODO:** –û–±–Ω–æ–≤–∏—Ç—å TESTING.md (—Å–µ–∫—Ü–∏—è "Outside-In TDD"):
  ```markdown
  ### Workflow:
  1. Component Test (RED)
  2. Unit Tests (RED)
  3. Implementation (GREEN)
  4. **Manual E2E test** (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, debug –ª–æ–≥–∏) ‚Üê –ù–û–í–û–ï
  5. Regression tests (–µ—Å–ª–∏ –±–∞–≥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω)
  6. Refactor
  ```

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:** Manual E2E –¥–µ–ª–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ GREEN (—Å–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞)

---

## üìã –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [ ] **TESTING.md:**
  - –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "Research-First –¥–ª—è External APIs" –≤ –ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫
  - –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "–ü—Ä–∞–≤–∏–ª–∞ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è" –≤ –ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫
  - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "Manual E2E –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
  - –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç "External API ‚Üí Research-First"

- [ ] **CLAUDE.md:**
  - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ü–µ—Ä–µ–¥ External API ‚Üí Research-First"
  - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∏–ø–∞ ‚Üí Grep —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ"
  - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ë–∞–≥-—Ñ–∏–∫—Å workflow ‚Üí –ù–ï –∑–∞–≤–µ—Ä—à–∞—Ç—å –±–µ–∑ proof"
  - –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å "Mock —Ç–æ–ª—å–∫–æ boundaries" –≤ TDD Workflow

- [ ] **ROLES.md:**
  - –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç –¥–ª—è Swift Developer: "–ü–µ—Ä–µ–¥ Write ‚Üí Grep —Ç–∏–ø—ã"
  - –û–±–Ω–æ–≤–∏—Ç—å Testing Architect: —Å—Å—ã–ª–∫–∞ –Ω–∞ Research-First —á–µ–∫–ª–∏—Å—Ç

---

## üìà –í—ã–≤–æ–¥—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è

### –ì–ª–∞–≤–Ω—ã–µ —É—Ä–æ–∫–∏:

1. **Research-First –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è External APIs:**
   - –ë–µ–∑ Research-First: 100% –±–∞–≥–æ–≤
   - –° Research-First: 0% –±–∞–≥–æ–≤
   - **–ì–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é**

2. **Manual E2E —Å–ø–∞—Å–∞–µ—Ç –æ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫:**
   - –û–±–Ω–∞—Ä—É–∂–∏–ª 2 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞ (–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—Ä—Ö–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã)
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **–≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**, –Ω–µ –≤ –∫–æ–Ω—Ü–µ

3. **–ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–≥–¥–∞ –∏—Ö —á–∏—Ç–∞—é—Ç:**
   - "Mock —Ç–æ–ª—å–∫–æ boundaries" –≤ TESTING.md ‚Üí –Ω–∞—Ä—É—à–µ–Ω (–Ω–µ –ø—Ä–æ—á–∏—Ç–∞–Ω)
   - –ù—É–∂–Ω–æ: **–ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫** + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ CLAUDE.md

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–∞–∫ reviewer —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:**
   - 2/2 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
   - Culture + explicit rules = —É—Å–ø–µ—Ö

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π:

**üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Å–¥–µ–ª–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –¥–Ω—è):**
1. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "Research-First –¥–ª—è External APIs" –≤ –ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫ TESTING.md
2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "Mock —Ç–æ–ª—å–∫–æ boundaries" –≤ –ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫ TESTING.md
3. –î–æ–±–∞–≤–∏—Ç—å –≤ CLAUDE.md —Å–µ–∫—Ü–∏—é "–ü–µ—Ä–µ–¥ External API ‚Üí Research-First"

**üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Å–¥–µ–ª–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –¥–Ω–µ–π):**
4. –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç "Grep —Ç–∏–ø—ã –ø–µ—Ä–µ–¥ Write" –≤ CLAUDE.md + ROLES.md
5. –î–æ–±–∞–≤–∏—Ç—å workflow "–ë–∞–≥-—Ñ–∏–∫—Å ‚Üí –ù–ï –∑–∞–≤–µ—Ä—à–∞—Ç—å –±–µ–∑ proof" –≤ CLAUDE.md
6. –û–±–Ω–æ–≤–∏—Ç—å TESTING.md: Manual E2E –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (backlog):**
7. –°–æ–∑–¥–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ä–µ–∞–ª—å–Ω—ã—Ö JSON –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è TDLib
8. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è: pre-commit hook –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö Mock* —Ñ–∞–π–ª–æ–≤

---

**–°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 2025-12-13 (—á–µ—Ä–µ–∑ 3 –¥–Ω—è –ø–æ—Å–ª–µ v0.4.0 start)

## üèÅ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤—ã v0.3.0

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-12-10

### –†–µ–∑—é–º–µ

**–í—Å–µ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–æ:**
- ‚úÖ 5 –≥–∏–ø–æ—Ç–µ–∑ –∏–∑ —Ä–µ—Ç—Ä–æ 2024-11 (1 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞, 4 –æ—Ç–ª–æ–∂–µ–Ω—ã –¥–æ v0.4.0)
- ‚úÖ 6 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ v0.4.0 —Å–æ—Å—Ç–∞–≤–ª–µ–Ω
- ‚úÖ –ó–∞–¥–∞—á–∏ –≤ TASKS.md –æ–±–Ω–æ–≤–ª–µ–Ω—ã

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**
1. **Research-First –∫—Ä–∏—Ç–∏—á–µ–Ω** ‚Äî —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Å 100% –¥–æ 0%
2. **–ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–≥–¥–∞ –∏—Ö —á–∏—Ç–∞—é—Ç** ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ –ø–µ—Ä–≤—ã–µ 30 —Å—Ç—Ä–æ–∫
3. **Manual E2E —Å–ø–∞—Å–∞–µ—Ç** ‚Äî –æ–±–Ω–∞—Ä—É–∂–∏–ª 2 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–∞–∫ reviewer** ‚Äî 2/2 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–¥ v0.4.0:**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å TESTING.md (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞–≤–µ—Ä—Ö)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏: Senior Code Reviewer, Bugfix Specialist
- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å Senior Swift Architect (—á–µ–∫–ª–∏—Å—Ç 7 –±–ª–æ–∫–æ–≤)
- [ ] –°–æ–∑–¥–∞—Ç—å retro-v0.4.0-questions.md (‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤ v0.4.0:**
- Research-First: 100% (‚Üë —Å 25%)
- Mock —Ç–æ–ª—å–∫–æ boundaries: 100% (‚Üë —Å 0%)
- –î—É–±–ª–∏–∫–∞—Ç—ã —Ç–∏–ø–æ–≤: 0% (‚Üì —Å 16%)
- Code Review: 100% –¥–Ω–µ–π (–Ω–æ–≤–æ–µ)
- Concurrency: 0 —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–æ–≤ (–Ω–æ–≤–æ–µ)

**–ì–∏–ø–æ—Ç–µ–∑—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ v0.4.0:**
- –ì–∏–ø–æ—Ç–µ–∑–∞ 1.3 "Overnight Pause" (Code Review)
- –ì–∏–ø–æ—Ç–µ–∑–∞ "Concurrency-Aware Architecture" (1.1 + 1.4 + 1.5)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:**
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É #1 –∏–∑ TASKS.md (–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ v0.4.0: –£—Å–∏–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
- –ù–∞—á–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (–ø—Ä–æ–º–ø—Ç –≤ retro-v0.4.0-questions.md)

---

**–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ v0.3.0 –∑–∞–≤–µ—Ä—à–µ–Ω–∞** ‚úÖ
